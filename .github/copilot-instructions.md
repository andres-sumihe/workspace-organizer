# Workspace Organizer – Agent Guide

- **Monorepo layout**: Root `package.json` manages npm workspaces for `apps/api`, `apps/web`, and `packages/shared`. Always run commands from the repo root so workspace resolution works.
- **Dev workflow**: Use `npm install` once, then `npm run dev` to launch API (port 4000) and Vite web client (port 5173) via `concurrently`. Individual targets exist as `npm run dev:api` and `npm run dev:web`. Build both with `npm run build`. There is no formal test suite yet.
- **Stack versions**: Target Node.js ≥ 20 (ESM/NodeNext), TypeScript 5.6, Express 4.x, tsx 4.x for API dev, SQLite (`sqlite`/`sqlite3`) for persistence, and React 18.3 with Vite 5.4 on the frontend. Keep dependencies pinned unless instructed otherwise.
- **TypeScript setup**: `tsconfig.base.json` is shared. Projects compile in `NodeNext` module mode; keep imports ESM-compatible and prefer extensionless relative paths resolved by TypeScript. Shared path alias is `@workspace/shared/*` → `packages/shared/src/*`.
- **Linting/formatting**: ESLint is configured in `.eslintrc.cjs` (TypeScript + React overrides). Run `npm run lint`. Prettier is configured via `.prettierrc.json`; `npm run format` verifies formatting.
- **Shared contracts**: Place cross-app interfaces in `packages/shared/src`. The current file defines template, token, and project metadata shapes used by both API and web apps. Update this package first when adjusting shared types, then rebuild dependents.
- **API service (`apps/api`)**: Express 4 app (TypeScript ESM) with entry `src/index.ts`, routes prefixed under `/api`. `src/config/env.ts` centralizes environment configuration. When adding modules, export routers from `src/routes` and mount them in `apiRouter`.
- **Environment variables**: Only `PORT` is configurable for the API. Workspace metadata and SQLite location are internal to the project structure.
- **Filesystem expectations**: All future file I/O should resolve paths under the workspace root determined above. Avoid hard-coding absolute paths in business logic; inject workspace context instead.
- **Web client (`apps/web`)**: Vite 5 + React 18 + TypeScript. Entry `src/main.tsx` hydrates `App.tsx`, which currently hits `/api/health`. Keep API calls centralized and respect `import.meta.env.VITE_API_URL` overrides when adding data fetching.
- **Configuration files**: `apps/web/vite.config.ts` proxies `/api` to the backend during development; adjust there if backend ports change. Add non-code assets under `apps/web/public` if needed.
- **Persistence & future work**: SQLite packages (`sqlite`, `sqlite3`) are already dependencies for the API but not yet wired. When implementing storage or watchers, keep the main DB file outside of `apps/api/dist` and ensure migrations/scripts live under `apps/api/src/db` (create this folder if needed).
- **General conventions**: Prefer small modules with explicit exports, avoid default exports unless matching existing patterns, and add succinct comments only for non-obvious logic. Maintain ASCII-only files unless extending existing Unicode content.

If anything remains unclear or new conventions emerge, document them here after implementation to keep future agents aligned. Let me know which sections need refinement. 